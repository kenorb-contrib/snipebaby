var n3tSeznamCaptcha=new Class({Implements:[Options],options:{url:"",audio:true,loading:false},player:null,initialize:function(a){this.setOptions(a);$$(".seznam-captcha").each((function(b){this.loadCaptcha(b)}).bind(this))},loadCaptcha:function(a){if(this.options.loading){a.addClass("loading")}new Request({method:"get",emulation:false,url:this.options.url+"/plugins/captcha/n3tseznamcaptcha/captcha.create.php",onSuccess:(function(b,c){this.createCaptcha(a,b);a.removeClass("loading");a.removeClass("error")}).bind(this),onFailure:(function(b){a.removeClass("loading");a.addClass("error")}).bind(this)}).send()},supportsAudio:function(){return typeOf(window.Audio)!="null"&&!Browser.ie},supportsEmbed:function(){if(Browser.ie){return true}return navigator.mimeTypes["audio/wav"]&&navigator.mimeTypes["audio/wav"].enabledPlugin},createCaptcha:function(f,d){if(!f.retrieve("hash")){var b=new Element("img",{"class":"seznam-captcha-image",alt:Joomla.JText._("PLG_CAPTCHA_N3TSEZNAMCAPTCHA_CAPTCHA")}).inject(f);f.store("image",b);var a=new Element("div",{"class":"seznam-captcha-controls"}).inject(f);if(this.options.audio){f.store("player",null);b=new Element("a",{title:Joomla.JText._("PLG_CAPTCHA_N3TSEZNAMCAPTCHA_AUDIO_TITLE"),"class":"seznam-captcha-audio"}).inject(a);b.set("html","<span>"+Joomla.JText._("PLG_CAPTCHA_N3TSEZNAMCAPTCHA_AUDIO")+"</span>");f.store("audio",b);b.addEvent("click",(function(i){var j=i.target.getParent(".seznam-captcha");var g=j.retrieve("audio").get("href");var h=j.retrieve("player");if(this.supportsAudio()){if(h){h.dispose()}h=new Audio(g);h.play();i.stop()}else{if(this.supportsEmbed()){if(!h){h=new Element("div",{style:{display:"none"}}).inject(j)}h.set("html",'<embed src="'+g+'" autostart hidden type="audio/x-wav" />');i.stop()}}j.store("player",h)}).bind(this));b=new Element("br",{}).inject(a)}b=new Element("a",{href:"#",title:Joomla.JText._("PLG_CAPTCHA_N3TSEZNAMCAPTCHA_RELOAD_TITLE"),"class":"seznam-captcha-reload"}).inject(a);b.set("html","<span>"+Joomla.JText._("PLG_CAPTCHA_N3TSEZNAMCAPTCHA_RELOAD")+"</span>");b.addEvent("click",(function(g){this.loadCaptcha(g.target.getParent(".seznam-captcha"));g.stop()}).bind(this));b=new Element("input",{type:"hidden",name:"jform[captcha_hash]"}).inject(f);f.store("hash",b);var c=f.getParent("form");var e=typeOf(c)!="null"&&c.hasClass("form-validate");b=new Element("input",{type:"text",name:"jform[captcha]",id:"jform_captcha","class":"seznam-captcha-answer",size:5,maxlength:5,autocomplete:"off"}).inject(f);if(e){b.addClass("required");b.set("aria-required","true");b.set("required","required");b.addEvent("blur",function(){return document.formvalidator.validate(this)})}}f.retrieve("hash").set("value",d);f.retrieve("image").set("src","http://captcha.seznam.cz/captcha.getImage?hash="+d);if(this.options.audio){if(!this.supportsAudio()&&!this.supportsEmbed()){f.retrieve("audio").set("href",this.options.url+"/plugins/captcha/n3tseznamcaptcha/captcha.audio.php?hash="+d+"&d=1")}else{f.retrieve("audio").set("href","http://captcha.seznam.cz/captcha.getAudio?hash="+d)}}}});